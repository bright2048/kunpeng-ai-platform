# 鲲鹏产业源头创新中心 - 后续开发建议

## 当前状态

✅ **纯静态网站已成功部署和运行**
- 完整的8个服务模块展示
- 响应式设计，支持移动端
- 深色科技主题
- 已在 cloud.szkpic.com 服务器上成功部署

## 已完成的后端准备工作

在之前的开发中，我们已经完成了完整的后端架构设计和实现：

### 1. 数据库设计（已完成）

位置：`drizzle/schema.ts`

包含8个核心数据表：
- `users` - 用户表（支持邮箱密码认证）
- `enterprise_auth` - 企业认证表
- `balance` - 余额充值记录表
- `orders` - 订单表
- `compute_resources` - 算力资源表
- `space_resources` - 空间资源表
- `invoices` - 发票管理表
- `admin_logs` - 管理员操作日志表

### 2. 后端API实现（已完成）

位置：`server/routes.ts` 和 `server/lib/`

完整的tRPC API路由：
- **认证模块**：注册、登录、登出
- **用户模块**：个人信息管理、企业认证申请
- **资源模块**：算力和空间资源查询
- **订单模块**：创建订单、查询订单、支付订单
- **管理员模块**：用户管理、资源管理、订单管理、企业认证审核、发票管理

### 3. 认证系统（已完成）

位置：`server/lib/auth.ts`

- 邮箱密码认证（使用bcrypt加密）
- JWT token生成和验证
- 完整的用户注册和登录流程

## 为什么回滚到静态版本？

在尝试将静态网站升级为全栈应用时遇到了技术问题：
1. 从OAuth切换到邮箱认证涉及大量底层改动
2. 前端页面出现空白，可能是组件依赖或配置冲突
3. 为了保证网站正常运行，回滚到已验证的静态版本

## 后续开发路线图

### 方案A：基于现有代码继续开发（推荐）

**优势**：后端代码已经完全实现并测试通过，只需要完成前端开发

**步骤**：

#### 第1步：恢复后端功能
```bash
# 1. 恢复数据库配置
# 确保 DATABASE_URL 环境变量已配置

# 2. 推送数据库schema
pnpm db:push

# 3. 测试数据库连接
# 可以通过管理界面或命令行测试
```

#### 第2步：修复前端配置
需要检查和修复的文件：
- `client/src/main.tsx` - tRPC客户端配置
- `client/src/App.tsx` - 路由配置
- 确保没有重复的Provider

#### 第3步：开发前端页面

**3.1 登录注册页面** (`client/src/pages/Login.tsx`)
- 邮箱密码登录表单
- 注册表单
- 表单验证
- 调用 `trpc.auth.register` 和 `trpc.auth.login`

**3.2 用户中心** (`client/src/pages/UserCenter.tsx`)
包含5个模块：
- 个人信息管理
- 企业认证申请
- 余额和充值
- 订单历史
- 发票管理

**3.3 管理员后台** (`client/src/pages/AdminDashboard.tsx`)
包含5个模块：
- 用户管理（查看、编辑、删除用户）
- 资源管理（管理算力和空间资源）
- 订单管理（查看、处理订单）
- 企业认证审核
- 发票管理

**3.4 资源展示页面**
- 展示可用的算力资源
- 展示可用的空间资源
- 在线下单功能

#### 第4步：集成和测试
- 测试完整的用户注册和登录流程
- 测试用户中心所有功能
- 测试管理员后台所有功能
- 测试订单流程

#### 第5步：部署到生产环境
- 构建生产版本
- 配置生产环境数据库
- 部署到 cloud.szkpic.com
- 配置HTTPS证书

### 方案B：渐进式开发（更稳妥）

从静态网站开始，逐步添加功能：

#### 阶段1：添加联系表单
- 简单的联系我们表单
- 使用邮件发送或存储到数据库
- 不需要用户登录

#### 阶段2：添加资源展示
- 展示算力和空间资源列表
- 静态数据或从API获取
- 不需要用户登录

#### 阶段3：添加用户认证
- 实现登录注册功能
- 添加用户中心基础功能

#### 阶段4：添加订单系统
- 实现在线下单
- 订单管理

#### 阶段5：添加管理后台
- 完整的管理员功能

## 技术栈说明

### 前端
- **框架**：React 18 + TypeScript
- **构建工具**：Vite
- **样式**：Tailwind CSS
- **路由**：Wouter
- **UI组件**：shadcn/ui
- **状态管理**：React Query (通过tRPC)

### 后端
- **框架**：Express + tRPC
- **数据库**：MySQL (使用Drizzle ORM)
- **认证**：JWT + bcrypt
- **API类型安全**：tRPC (端到端类型安全)

### 部署
- **服务器**：CentOS 8
- **Web服务器**：Nginx
- **进程管理**：PM2
- **域名**：cloud.szkpic.com

## 关键代码位置

### 数据库
- Schema定义：`drizzle/schema.ts`
- 数据库操作：`server/lib/db-helpers.ts`
- 配置：`drizzle.config.ts`

### 后端API
- 路由定义：`server/routes.ts`
- 认证逻辑：`server/lib/auth.ts`
- tRPC配置：`server/lib/trpc.ts`

### 前端
- 主入口：`client/src/main.tsx`
- 路由配置：`client/src/App.tsx`
- tRPC客户端：`client/src/lib/trpc.ts`
- 页面组件：`client/src/pages/`

### 部署
- Docker配置：`Dockerfile`, `docker-compose.yml`
- Nginx配置：`nginx.conf`
- 部署文档：`SIMPLE_DOCKER_DEPLOYMENT.md`

## 开发文档

详细的开发指南已经创建：
- `DEVELOPMENT_GUIDE.md` - 完整的开发指南
- `SIMPLE_DOCKER_DEPLOYMENT.md` - 部署指南
- `db/schema.ts` - 数据库设计文档

## 建议

1. **如果您有开发团队**：建议采用方案A，后端已经完全准备好，只需要完成前端开发

2. **如果需要快速上线**：建议采用方案B，先保持静态网站运行，逐步添加功能

3. **如果需要外部帮助**：所有的后端代码、数据库设计和API文档都已准备好，可以直接交给开发团队继续开发

## 联系支持

如果在开发过程中遇到问题，可以：
1. 查看 `DEVELOPMENT_GUIDE.md` 获取详细指导
2. 检查后端代码中的注释和类型定义
3. 参考已实现的API路由和数据库操作函数

## 总结

当前项目状态：
- ✅ 静态网站完全正常运行
- ✅ 后端API完全实现
- ✅ 数据库设计完成
- ✅ 认证系统实现
- ⏳ 前端页面需要开发（登录、用户中心、管理后台）

**下一步最重要的工作**：完成前端页面开发，连接已有的后端API。
